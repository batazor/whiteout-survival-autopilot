name: Upgrade Alliance Tech # –ù–∞–∑–≤–∞–Ω–∏–µ usecase ‚Äî —É–ª—É—á—à–µ–Ω–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∞–ª—å—è–Ω—Å–∞

node: alliance_tech         # –°—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω ‚Äî "—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∞–ª—å—è–Ω—Å–∞"

priority: 15

ttl: 90m                    # –¢–∞–π–º–∞—É—Ç: –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ 90 –º–∏–Ω—É—Ç

steps:
  - action: screenshot               # üì∏ –ò—â–µ–º –∏–∫–æ–Ω–∫—É —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ —Å –∑–µ–ª—ë–Ω—ã–º –ø–∞–ª—å—Ü–µ–º –≤–≤–µ—Ä—Ö (–∏–∑–±—Ä–∞–Ω–Ω–∞—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è)
    analyze:
      - name: alliance.tech.favorite
        action: findIcon
        threshold: 0.8
        saveAsRegion: true          # üíæ –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–æ–Ω—É –Ω–∞–π–¥–µ–Ω–Ω–æ–π –∏–∫–æ–Ω–∫–∏ –ø–æ–¥ –∏–º–µ–Ω–µ–º alliance.tech.favorite

  - click: alliance.tech.favorite   # üëâ –ö–ª–∏–∫–∞–µ–º –ø–æ –Ω–∞–π–¥–µ–Ω–Ω–æ–π —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å —ç–∫—Ä–∞–Ω —Å –∫–Ω–æ–ø–∫–æ–π "Contribute"

  - wait: 200ms # –ñ–¥–µ–º –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –∞–Ω–∏–º–∞—Ü–∏–∏

  - action: screenshot               # üì∏ –î–µ–ª–∞–µ–º —Å–∫—Ä–∏–Ω—à–æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —ç–∫—Ä–∞–Ω–∞
    analyze:
      - name: alliance.state.isAllianceContributeButton
        action: color_check          # üé® –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ü–≤–µ—Ç –∫–Ω–æ–ø–∫–∏ "Contribute"
        expectedColor: blue
        threshold: 0.5

  - if:
      trigger: "alliance.state.isAllianceContributeButton == false"
      then:
        - click: alliance_tech_contribute_back

  - action: loop                     # üîÅ –ó–∞–ø—É—Å–∫–∞–µ–º —Ü–∏–∫–ª, –ø–æ–∫–∞ –∫–Ω–æ–ø–∫–∞ "Contribute" –æ—Å—Ç–∞—ë—Ç—Å—è —Å–∏–Ω–µ–π
    trigger: "alliance.state.isAllianceContributeButton == true"
    steps:
      - longtap: alliance.state.isAllianceContributeButton
        wait: 3s                     # üß∑ –£–¥–µ—Ä–∂–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É (longtap) 3 —Å–µ–∫—É–Ω–¥—ã ‚Äî —ç—Ç–æ —É—Å–∏–ª–∏–≤–∞–µ—Ç –≤–∫–ª–∞–¥

      - action: screenshot           # üì∏ –ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è —Å–Ω–æ–≤–∞ –¥–µ–ª–∞–µ–º —Å–∫—Ä–∏–Ω—à–æ—Ç
        analyze:
          - name: alliance.state.isAllianceContributeButton
            action: color_check
            expectedColor: blue
            threshold: 0.5

      - if:
          trigger: "alliance.state.isAllianceContributeButton == false"
          then:
            - click: alliance_tech_contribute_back
            - action: loop_stop      # üõë –ï—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ —Å—Ç–∞–ª–∞ —Å–µ—Ä–æ–π (–Ω–µ–ª—å–∑—è –∂–∞—Ç—å), –≤—ã—Ö–æ–¥–∏–º –∏–∑ —Ü–∏–∫–ª–∞
